# Java Annotations
Modifiers in Java (static, final, public, ...) are meta-data describing properties of program elements (meta-datas since they do not define semantics, they affects visibility).
They are keywords thus wired-in in the language, we need an additional mechanisms for providing meta-data without chaning the language: *annotations* can be seen as (user-)definable modifiers.

## Structure of Annotations
Annotations are made of
- name
- finite number (possibly none) of attributes, i.e. "name = value"

### Syntax
- `@annotationName` without attributes, e.g. `@Override`
- `@annotationName{name_1 = constExp_1, ..., name_k = constExp_k}`
	- `constExp_i` are expressions that can be evaluated at compile time
	- attributes have a type, thus the supplied values have to be convertible to that type

## Define your own Annotations
Programmers can define new annotations, which have a similar declaration syntax to interfaces but starting with `@interface`. Each annotation class implement the interface `Annotation`, this is done automatically by the compiler. 

Typically an annotation type is an interface definiing fields corresponding to the attributes

*example: definition of an annotation*
```java
@interface InfoCode{
	String author ();
	String date (); 
	int ver () default 1;
	int rev () default 0;
	String [] changes () default {};
}
```
- Each method determines the name of an attribute and its type (the return type)
- a default value can be specified for each attribute
- attributes types can only be primitive, String, Class, Enum, Annotation or an array of those types

```java
@InfoCode(author="relli", date="27/4/2022")
public class C{
	public static void m1() {...}

	@InfoCode(author="futureRelli", date="28/4/2022", rev=2)
	publuc static void m2() {...}
}
```

## Annotating Annotations
Annotation definitions can be annotated to describe their meta-data. An annotation of an annotation is called meta-annotation. 
Some predefined meta-annotations:
- `@Target`: Constrains the program elements to which the annotation can be applied. The value type is `annotation.ElementType[]`, in this array we put the types to which we can apply the annotation
- `@Retention`: Until when the annotation should be present? Three possible options (values of enum `RetentionPolicy`): 
	- `SOURCE`: annotations are discarded at compile time
	- `CLASS`: the default value, the annotations are kept in the class file generated by the compilation but they can't be seen at runtime since they are not reified
	- `RUNTIME`: the annotations are kept at runtime, which can be usefull for relfection

## Use Java Reflection with Annotations
[[Java Reflection]] can also be used to retrieve annotations, using the methods defined in `java.lang.reflect`
- `Annotation[] getAnnotations()`: in class `Class`, it returns an array of `Annotation` instances 
- `<T extends Annotation> T getAnnotation(Class<T> annotationClass)`: in class `Method`, it returns this element's annotation for the specified type if such annotation exists, otherwise `null`.